# ุฑุงูููุง Live Sensor Dashboard ู API

ุงู ุฑุงูููุง ูุญูู ุงุณุชูุงุฏู ุงุฒ ุณุณุชู ููุงุด ุฏุงุฏูโูุง ูุณุชูู ุงุฒ ุณูุณูุฑูุง (ุจุฏูู ูุงุจุณุชฺฏ ุจู ุฏุชุงุจุณ) ุฑุง ุชูุถุญ ูโุฏูุฏ.

## ๐ฏ ูฺฺฏโูุง

- โ **ุฏุงุฏูโูุง Real-time**: ููุงุด ูุณุชูู ุงุฒ MQTT ุจุฏูู ุฐุฎุฑู ุฏุฑ ุฏุชุงุจุณ
- โ **WebSocket**: ุจุฑูุฒุฑุณุงู ุฎูุฏฺฉุงุฑ ุฏุงุดุจูุฑุฏ
- โ **API ฺฉุงูู**: ุฏุณุชุฑุณ ุจู ุฏุงุฏูโูุง live ุงุฒ ุทุฑู REST API
- โ **ุขูุงุฑ ุฒูุฏู**: ุดูุงุฑุด ุฏุณุชฺฏุงูโูุง ู ุงููุงุน ุณูุณูุฑูุง
- โ **ุชุงุฑุฎฺู**: ูฺฏูุฏุงุฑ ุขุฎุฑู 1000 ุฑฺฉูุฑุฏ ูุฑ ุฏุณุชฺฏุงู ุฏุฑ ุญุงูุธู
- โ **UI ุฒุจุง**: ุฏุงุดุจูุฑุฏ ูุงุฑุณ ุจุง ุทุฑุงุญ ูุฏุฑู

## ๐ ูุตุจ ู ุฑุงูโุงูุฏุงุฒ

### 1. ูุตุจ Dependencies

```bash
pip install -r requirements_live.txt
```

### 2. ุฑุงูโุงูุฏุงุฒ MQTT Broker

```bash
# ุจุง Docker
docker-compose up -d broker

# ุง ุงุฌุฑุง ุฏุณุช Mosquitto
mosquitto -c mosquitto/mosquitto.conf
```

### 3. ุงุฌุฑุง Live Dashboard

```bash
python realtime_dashboard.py
```

**ุฏุณุชุฑุณ:**
- ุฏุงุดุจูุฑุฏ: http://localhost:5000
- WebSocket: ws://localhost:5000/socket.io/

### 4. ุงุฌุฑุง Live API

```bash
python live_sensor_api.py
```

**ุฏุณุชุฑุณ:**
- API: http://localhost:5001
- ูุณุชูุฏุงุช: http://localhost:5001/

## ๐ Live Dashboard

### ูฺฺฏโูุง ุฏุงุดุจูุฑุฏ:

- **ููุงุด Real-time**: ุฏุงุฏูโูุง ุจู ูุญุถ ุฏุฑุงูุช ุงุฒ MQTT ููุงุด ุฏุงุฏู ูโุดููุฏ
- **ูุถุนุช ุงุชุตุงู**: ูุดุงูฺฏุฑ ุขููุงู/ุขููุงู ุฏุณุชฺฏุงูโูุง
- **ุดูุงุฑุด ุฏุณุชฺฏุงูโูุง**: ุชุนุฏุงุฏ ุฏุณุชฺฏุงูโูุง ูุชุตู
- **ุชุงุฑุฎฺู**: ุขุฎุฑู ุจุฑูุฒุฑุณุงู ูุฑ ุฏุณุชฺฏุงู
- **ฺฉูุชุฑูโูุง**: ูพุงฺฉ ฺฉุฑุฏู ุฏุงุฏูโูุง ู ุชููู/ุดุฑูุน ุจุฑูุฒุฑุณุงู

### ูุญูู ุงุณุชูุงุฏู:

1. ุฏุงุดุจูุฑุฏ ุฑุง ุจุงุฒ ฺฉูุฏ: http://localhost:5000
2. ุณูุณูุฑูุง ุฑุง ุฑุงูโุงูุฏุงุฒ ฺฉูุฏ (mqtt_simulator.py)
3. ุฏุงุฏูโูุง ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ููุงุด ุฏุงุฏู ูโุดููุฏ

## ๐ Live API

### Endpoints ููุฌูุฏ:

#### 1. ุขูุงุฑ ฺฉู
```http
GET /api/live/stats
```

**ูพุงุณุฎ:**
```json
{
  "success": true,
  "stats": {
    "total_devices": 5,
    "active_devices": 4,
    "sensor_type_counts": {
      "temperature": 2,
      "humidity": 1,
      "light": 1
    },
    "room_counts": {
      "room1": 3,
      "room2": 1
    },
    "device_list": ["temp-1", "temp-2", "hum-1"],
    "timestamp": "2024-01-15T10:30:00",
    "data_source": "live_mqtt"
  }
}
```

#### 2. ูุณุช ุฏุณุชฺฏุงูโูุง
```http
GET /api/live/devices
```

#### 3. ุฏุงุฏู ุฏุณุชฺฏุงู ุฎุงุต
```http
GET /api/live/device/{device_id}
```

#### 4. ุชุงุฑุฎฺู ุฏุณุชฺฏุงู
```http
GET /api/live/device/{device_id}/history?limit=50
```

#### 5. ุฏุงุฏู ุงุชุงู
```http
GET /api/live/room/{room_id}
```

#### 6. ุฏุงุฏู ููุน ุณูุณูุฑ
```http
GET /api/live/sensors/{sensor_type}
```

#### 7. ูุถุนุช ุณุณุชู
```http
GET /api/live/health
```

## ๐งช ุชุณุช ุณุณุชู

### 1. ุงุฌุฑุง ุดุจูโุณุงุฒ ุณูุณูุฑูุง

```bash
python mqtt_simulator.py
```

### 2. ุชุณุช API ุจุง curl

```bash
# ุขูุงุฑ ฺฉู
curl http://localhost:5001/api/live/stats

# ุฏุณุชฺฏุงูโูุง ูุชุตู
curl http://localhost:5001/api/live/devices

# ุฏุงุฏู ุฏุณุชฺฏุงู ุฎุงุต
curl http://localhost:5001/api/live/device/temp-1
```

### 3. ุชุณุช WebSocket

```javascript
// ุฏุฑ ูุฑูุฑฺฏุฑ (Console)
const socket = io('http://localhost:5000');
socket.on('sensor_data', (data) => {
    console.log('New sensor data:', data);
});
```

## ๐ง ุชูุธูุงุช

### ุชุบุฑ MQTT Broker

ุฏุฑ ูุงูโูุง `realtime_dashboard.py` ู `live_sensor_api.py`:

```python
mqtt_subscriber = LiveMQTTSubscriber(
    broker="your-broker-ip",  # ุชุบุฑ IP
    port=1883,                # ุชุบุฑ ูพูุฑุช
    topics=["your/topic/#"]   # ุชุบุฑ ููุถูุนุงุช
)
```

### ุชุบุฑ ูพูุฑุชโูุง

```python
# Dashboard
socketio.run(app, host='0.0.0.0', port=5000)

# API
app.run(host='0.0.0.0', port=5001)
```

## ๐ ููุงุณู ุจุง ุณุณุชู ุฏุชุงุจุณ

| ูฺฺฏ | Live System | Database System |
|--------|-------------|-----------------|
| **ุณุฑุนุช** | โก ููุฑ | ๐ ุชุงุฎุฑ ุฐุฎุฑู/ุฎูุงูุฏู |
| **ุญุงูุธู** | ๐พ ูุญุฏูุฏ (1000 ุฑฺฉูุฑุฏ) | ๐พ ูุงูุญุฏูุฏ |
| **ูพุงุฏุงุฑ** | โ๏ธ ูููุช | โ ุฏุงุฆู |
| **ุชุญูู** | ๐ ุณุงุฏู | ๐ ูพุดุฑูุชู |
| **Backup** | โ ูุฏุงุฑุฏ | โ ุฏุงุฑุฏ |

## ๐จ ูฺฉุงุช ููู

1. **ุญุงูุธู**: ุฏุงุฏูโูุง ููุท ุฏุฑ ุญุงูุธู ูฺฏูุฏุงุฑ ูโุดููุฏ
2. **ูพุงุฏุงุฑ**: ุจุง restart ุณุฑูุฑุ ุฏุงุฏูโูุง ุงุฒ ุจู ูโุฑููุฏ
3. **ููุงุณโูพุฐุฑ**: ุจุฑุง ุชุนุฏุงุฏ ูุญุฏูุฏ ุฏุณุชฺฏุงู ููุงุณุจ ุงุณุช
4. **ุงููุช**: ูุนูุงู authentication ูุฏุงุฑุฏ

## ๐ ุชุฑฺฉุจ ุจุง ุณุณุชู ุฏุชุงุจุณ

ูโุชูุงูุฏ ูุฑ ุฏู ุณุณุชู ุฑุง ููุฒูุงู ุงุฌุฑุง ฺฉูุฏ:

```bash
# Terminal 1: Live Dashboard
python realtime_dashboard.py

# Terminal 2: Live API  
python live_sensor_api.py

# Terminal 3: Database System
python web_dashboard.py

# Terminal 4: MQTT Subscriber (ุจุฑุง ุฏุชุงุจุณ)
python mqtt_subscriber.py
```

## ๐ ุนุจโุงุจ

### ูุดฺฉู: ุฏุงุฏูโุง ููุงุด ุฏุงุฏู ููโุดูุฏ

1. MQTT Broker ุฏุฑ ุญุงู ุงุฌุฑุง ุงุณุชุ
2. ุณูุณูุฑูุง ุฏุงุฏู ุงุฑุณุงู ูโฺฉููุฏุ
3. ููุถูุนุงุช MQTT ุฏุฑุณุช ุชูุธู ุดุฏูุ

### ูุดฺฉู: WebSocket ูุชุตู ููโุดูุฏ

1. ูพูุฑุช 5000 ุขุฒุงุฏ ุงุณุชุ
2. Firewall ูุณุฏูุฏ ูฺฉุฑุฏูุ
3. Browser ุงุฒ WebSocket ูพุดุชุจุงู ูโฺฉูุฏุ

### ูุดฺฉู: API ูพุงุณุฎ ููโุฏูุฏ

1. ูพูุฑุช 5001 ุขุฒุงุฏ ุงุณุชุ
2. MQTT Subscriber ูุชุตู ุงุณุชุ
3. ูุงฺฏโูุง ุฎุทุง ุฑุง ุจุฑุฑุณ ฺฉูุฏ

## ๐ ูพุดุชุจุงู

ุจุฑุง ุณูุงูุงุช ู ูุดฺฉูุงุช:
- ุจุฑุฑุณ ูุงฺฏโูุง console
- ุชุณุช ุงุชุตุงู MQTT ุจุง `mqtt-test.html`
- ุจุฑุฑุณ ูุถุนุช ุจุง `/api/live/health`
